$schema: 'https://moonrepo.dev/schemas/project.json'
language: 'typescript'
layer: 'application'
stack: 'backend'

tasks:
  build:
    command: 'pnpm'
    args: ['build']
    inputs:
      - 'src/**/*'
      - 'index.html'
      - "package.json"
      - "tsconfig.*"
      - "worker-configuration.d.ts"
      - "wrangler.*"
      - '/shared-wasm/*.wasm'
    outputs:
      - 'dist'
    deps:
      - 'shared-wasm:gather'

  lint:
    command: 'pnpm'
    args: ['biome', 'lint', '.']
    inputs:
      - "src/**/*"
      - "*.ts"
      - "*.js"
      - "biome.json"
      - "package.json"

  format:
    command: 'pnpm'
    args: ['biome', 'format', '--write', '.']
    inputs:
      - "src/**/*"
      - "*.ts"
      - "*.js"
      - "biome.json"
      - "package.json"

  check:
    command: 'pnpm'
    args: ['biome', 'check', '.']
    inputs:
      - "src/**/*"
      - "*.ts"
      - "*.js"
      - "biome.json"
      - "package.json"
